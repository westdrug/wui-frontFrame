var INDSERTREADY=function(a){};var KITYFORMULAlAYER="./libs/plugins/summernote/kityformula-plugins/kityFormulaLayer.html";(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(a){a.extend(a.summernote.plugins,{KityFormula:function(h){var d=this;var i=a.summernote.ui;var b="";var c;var f=function(){var k='<div class="layui-layer-shade" id="layui-layer-shade-kityformula" style="z-index:19891015; background-color:#000; opacity:0.3; filter:alpha(opacity=30);display: none"></div>';var j="";j+='<div class="layui-layer layui-anim layui-layer-iframe layui-layer-demo layer-kityformula" id="layui-layer-kityformula" type="iframe" times="2" showtime="0" contype="string" style="z-index: 19891016; width: 800px; height: 540px; margin: -270px 0 0 -400px;top: 50%;;display: none">';j+='<div class="layui-layer-title" style="cursor: move;" move="ok">插入公式-kityFormula</div>';j+='<div class="layui-layer-content">';j+='<iframe scrolling="auto" allowtransparency="true" id="layui-layer-iframe2" name="layui-layer-iframe2" onload="this.className=\'\';" class="" frameborder="0" src="'+KITYFORMULAlAYER+'" style="height: 442px;"></iframe>';j+="</div>";j+='<span class="layui-layer-setwin">';j+='<a class="layui-layer-ico layui-layer-close layui-layer-close1" href="javascript:;"></a>';j+="</span>";j+='<div class="layui-layer-btn">';j+='<a class="layui-layer-btn0">确定</a>';j+='<a class="layui-layer-btn1">取消</a>';j+="</div>";j+="</div>";a("body").append(k);a("body").append(j)};h.memo("button.KityFormula",function(){if(e.versions.aWebKit||e.versions.presto||e.versions.webApp){f()}var k=i.button({contents:'<i class="fa fa-slack"/>',tooltip:"插入公式-kityFormula",click:function(p){if(e.versions.gecko||e.versions.trident){f()}layer.closeAll();var m=window.getSelection().anchorNode;var o=a("#layui-layer-kityformula");var l=a("#layui-layer-shade-kityformula");var n=a(".layer-kityformula .layui-layer-btn0");if(m!=null){c=window.getSelection().getRangeAt(0)}else{c=undefined}if(o.is(":hidden")){l.show();o.show();n.attr("style","").text("确定");n.on("click",function(){window.setTimeout(function(){l.hide();o.hide()},1500);a(this).text("生成中...").css({cursor:"wait",opacity:".4"})});a(".layer-kityformula .layui-layer-btn1,.layer-kityformula .layui-layer-close1").on("click",function(){l.hide();o.hide()})}}});var j=k.render();return j});INDSERTREADY=function(j){a(document).on("click",".layer-kityformula .layui-layer-btn0",function(){j.execCommand("get.image.data",function(k){b=k.img})})};var g=function(j){var k=h.layoutInfo.editable.selector;a(document).on("click",".layer-kityformula .layui-layer-btn0",function(){var l=new Image();window.setTimeout(function(){l.src=b;l.className="kityformula-img";c.setEndAfter(document.querySelector(k).lastChild);c.insertNode(l);c.selectNode(document.querySelector(k))},1000)})};this.events={"summernote.init":function(j,k){g()},"summernote.keyup":function(j,k){}};var e={versions:function(){var j=navigator.userAgent;return{trident:j.indexOf("Trident")>-1,presto:j.indexOf("Presto")>-1,aWebKit:j.indexOf("AppleWebKit")>-1,gecko:j.indexOf("Firefox")>-1,webApp:j.indexOf("Safari")>-1}}()}}})}));